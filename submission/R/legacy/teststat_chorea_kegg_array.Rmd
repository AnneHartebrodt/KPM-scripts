---
title: "Chorea huntington"
output: html_document
---

Test whether the approach is likely to work by using a pathway which is
known in order to calculate the test statistics. 

```{r import}
require(data.table)
require(ggplot2)

```

# relevant genes
```{r}
chorea_genes<-fread("/home/anne/Documents/Master/MA/data/Kegg_Huntington_EntrezID.csv")
chorea_genes<-as.data.table(unique(unlist(chorea_genes)))
```


# expression p-values ulitsky

```{r}
pvals_raw<-fread("/home/anne/Documents/Master/MA/code/keypathwayminer-standalone/src/main/resources/huntington-gene-expression-DOWN.txt", header=T, sep="\t")
```

# comparison all pvals vs. mean!=1 pvals
Conclusion: Seems more sensible to only use genes, that have mean pvals:=1
```{r}
chor_p<-pvals_raw[ID %in% chorea_genes$V1]
chor_p<-chor_p[,2:39]
mean<-chor_p[,.(Mean = rowMeans(.SD))]
meanclean<-mean[!mean$Mean==1]

ggplot(as.data.table(unlist(chor_p)), aes(x=V1))+geom_histogram()

```


```{r}
test<--2*sum(log(mean))
testclean<--2*sum(log(meanclean))

testrand<-c(runif(108-91),meanclean$Mean)
testrand<--2*sum(log(testrand))

pchisq(test, 108, lower.tail = F)
pchisq(testclean, 91, lower.tail = F)
pchisq(testrand, 108, lower.tail = F)

```

Seems to be the most sensible to only use those p-values for the analysis, that are actual p-values.

